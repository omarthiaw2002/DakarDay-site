<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boutique en ligne avec Recherche</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Ajoutez ces lignes dans le <head> -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <style>
        .section {
            background: rgb(255, 255, 255);
            border-radius: 1px;
            padding: -15px;
            margin-bottom: 8px;
            box-shadow: 0 4px 8px rgba(10, 239, 18, 0.1);
        }
        .section-title {
            background: rgb(11, 231, 11);
            border-radius: 1px;
            font-weight: bold;
            font-size: 21px;
            margin-bottom: 10px;
            padding: 5px;
            height: 40px;
        }
        .carousel {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            gap: 5px;
            padding-bottom: 10px;
        }
        .carousel::-webkit-scrollbar {
            display: none;
        }
        .product-card {
            scroll-snap-align: start;
            min-width: 150px;
            text-align: center;
            cursor: pointer;
        }
        .product-image {
            width: 100%;
            height: 120px;
            background-color: #14d74f;
            border-radius: 8px;
            margin-bottom: 8px;
            object-fit: cover;
        }
        .product-name {
            font-size: 14px;
            margin: 5px 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .product-price {
            font-weight: bold;
            font-size: 14px;
        }
        
        /* Styles pour la modale de détails */
        .product-detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            
        }
        .product-detail-content {
            background: rgb(255, 255, 255);
            padding: 5px;
            border-radius: 8px;
            max-width: 92%;
            max-height: 100%;
            overflow: auto;
            position: relative;
        }
        .close-detail {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff0000;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-weight: bold;
            cursor: pointer;
        }
        
        /* Styles pour la barre de recherche */
        .search-container {
            position: relative;
            margin: 20px auto;
            margin-bottom: 0; /* Supprime la marge basse par défaut (était 20px) */
            padding-bottom: 0.5rem; /* Réduit le padding si nécessaire (au lieu de p-4) */

        }
        .search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            z-index: 100;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }
        .search-result-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
        }
        .search-result-item:hover {
            background-color: #f5f5f5;
        }
        .search-result-item img {
            width: 40px;
            height: 40px;
            object-fit: cover;
            margin-right: 10px;
            border-radius: 4px;
        }
        .search-result-info {
            flex: 1;
        }
        .search-result-name {
            font-weight: bold;
            margin-bottom: 2px;
        }
        .search-result-price {
            color: #e63946;
            font-weight: bold;
            font-size: 14px;
        }

        /* Nouveaux styles pour le carrousel dans les détails */
        .detail-carousel {
            display: flex;
            overflow-x: auto;
            scroll-snap-type: x mandatory;
            gap: 10px;
            padding-bottom: 10px;
            margin-bottom: 15px;
            
        }
        .detail-carousel::-webkit-scrollbar {
            display: none;
        }
        .detail-carousel-image {
            scroll-snap-align: start;
            min-width: 80%;
            height: auto;
            max-height: 300px;
            object-fit: contain;
            border-radius: 8px;
            cursor: pointer;
        }
        body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }
        
        /* Styles pour le panier */
        .cart-item {
            transition: all 0.3s ease;
        }
        .cart-item:hover {
            background-color: #f9fafb;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .animate-pulse {
            animation: pulse 1.5s infinite;
        }
        /* Style pour la notification d'ajout au panier */
.add-to-cart-notification {
    position: fixed;
    top: 50px;
    right: 20px;
    background-color: #10B981;
    color: white;
    padding: 2px 15px;
    border-radius: 4px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    z-index: 1000;
    display: none;
    animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

@keyframes slideOut {
    from { transform: translateX(0); opacity: 1; }
    to { transform: translateX(100%); opacity: 0; }
}
/* Styles pour le swiper publicitaire */
.ad-swiper {
    width: 100%;
    height: 150px;
    margin: 10px 0 20px;
     margin-top: 0; /* Supprime la marge haute (était 10px) */
    margin-bottom: 0.5rem; /* Réduit la marge basse si nécessaire */

}

.ad-swiper .swiper-slide {
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    overflow: hidden;
    background: #dd6c6cff;
}

.ad-swiper img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.ad-swiper .swiper-pagination-bullet {
    background: white;
    opacity: 0.6;
}

.ad-swiper .swiper-pagination-bullet-active {
    background: #10B981;
    opacity: 1;
}
    </style>
</head>
<body class="bg-white">
    <!-- Notification d'ajout au panier -->
<div id="cartNotification" class="add-to-cart-notification">
    Produit ajouté au panier !
</div>
    <!-- Panier latéral -->
    <div id="cart-sidebar" class="fixed inset-0 bg-black bg-opacity-50 z-30 hidden">
        <div class="absolute right-0 top-0 h-full w-full max-w-md bg-white shadow-xl overflow-y-auto">
            <div class="p-6">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-2xl font-bold">Votre Panier</h3>
                    <button class="close-cart text-gray-600">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
                
                <div id="cart-items-container" class="space-y-4 mb-6">
                    <!-- Les articles seront ajoutés ici dynamiquement -->
                    <div class="text-center py-8">
                        <i class="fas fa-shopping-cart text-gray-300 text-4xl mb-4"></i>
                        <p class="text-gray-500">Votre panier est vide</p>
                    </div>
                </div>
                
                <div class="border-t pt-4 mb-6">
                    <div class="flex justify-between font-bold text-lg mb-2">
                        <span>Sous-total:</span>
                        <span id="cart-subtotal">0,00 FCFA</span>
                    </div>
                   
                    <div class="flex justify-between font-bold text-xl">
                        <span>Total:</span>
                        <span id="cart-total" class="text-green-600">0,00 FCFA</span>
                    </div>
                </div>
                
                <a id="whatsapp-order-btn" href="#" 
                   target="_blank"
                   class="block w-full bg-green-600 text-white text-center py-3 rounded-lg mb-4 hover:bg-green-700 transition duration-300">
                    <i class="fab fa-whatsapp mr-2"></i> Commander via WhatsApp
                </a>
                
                <button class="w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 transition duration-300">
                    Valider la commande
                </button>
            </div>
        </div>
    </div>

   <!-- Header avec panier -->
<div class="flex justify-between items-center p-4 bg-white shadow-sm sticky top-0 z-10">
    <div class="text-2xl font-bold text-green-600">Ma Boutique</div>
    
    <div class="flex items-center space-x-4">
        <!-- Bouton panier -->
        <button class="cart-toggle relative">
            <i class="fas fa-shopping-cart text-2xl text-gray-700"></i>
            <span id="cart-count" class="absolute -top-2 -right-2 bg-green-600 text-white text-xs w-5 h-5 flex items-center justify-center rounded-full animate-pulse">0</span>
        </button>
    </div>
</div>
    <!-- Barre de recherche -->
    <div class="search-container p-4">
        <div class="relative">
            <input type="text" id="searchInput" 
                   class="w-full p-3 pl-10 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-green-500" 
                   placeholder="Rechercher des produits..." 
                   autocomplete="off">
            <div class="absolute left-3 top-3 text-gray-400">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                </svg>
            </div>
        </div>
        <div id="searchResults" class="search-results"></div>
    </div>
    <!-- Bannière publicitaire avec Swiper -->
    <div class="swiper ad-swiper px-4">
        <div class="swiper-wrapper">
            <!-- Slide 1 -->
            <div class="swiper-slide">
                <img src="hh.jpg" alt="Promotion 1">
            </div>
            <!-- Slide 2 -->
            <div class="swiper-slide">
                <img src="om.jpg" alt="Promotion 2">
            </div>
            <!-- Slide 3 -->
            <div class="swiper-slide">
                <img src="4 (2).jpg" alt="Promotion 3">
            </div>
        </div>
        <!-- Pagination -->
        <div class="swiper-pagination"></div>
    </div>

    <!-- Contenu principal -->
    <div class="container mx-auto px-4" id="product-sections">
        <!-- ... votre code existant ... -->
    </div>
    <!-- Contenu principal -->
    <div class="container mx-auto px-4" id="product-sections">
        <!-- Les sections de produits seront générées dynamiquement à partir du JSON -->
    </div>

    <!-- Modale de détails du produit -->
    <div id="productDetailModal" class="product-detail-modal">
        <div class="product-detail-content">
            <button class="close-detail" onclick="closeProductDetail()">×</button>
            <div id="detailCarousel" class="detail-carousel">
                <!-- Les images du carrousel seront ajoutées ici par JavaScript -->
            </div>
            <h2 id="detailProductName" class="text-xl font-bold mt-4"></h2>
            <p id="detailProductPrice" class="text-green-600 font-bold text-lg my-2"></p>
            <p id="detailProductDescription" class="text-gray-700 mb-4"></p>
            <button id="detailAddToCart" class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded-lg transition duration-200">
                Ajouter au panier
            </button>
        </div>
    </div>

    <script>
        // Variables globales
        let productsData = {};
        let allProducts = [];
        let cartItems = [];

        // Charger les données JSON
        async function loadProductsData() {
            try {
                const response = await fetch('products.json');
                productsData = await response.json();
                
                // Aplatir tous les produits pour la recherche
                allProducts = [];
                productsData.categories.forEach(category => {
                    category.products.forEach(product => {
                        allProducts.push(product);
                    });
                });
                
                // Générer les sections de produits
                generateProductSections();
            } catch (error) {
                console.error('Erreur lors du chargement des données:', error);
            }
        }

        // Gestion du panier
        const cartCount = document.getElementById('cart-count');
        const cartItemsContainer = document.getElementById('cart-items-container');
        const cartSubtotal = document.getElementById('cart-subtotal');
        const cartTotal = document.getElementById('cart-total');
        const whatsappOrderBtn = document.getElementById('whatsapp-order-btn');
        
        // Gestion du panier
        const cartToggle = document.querySelector('.cart-toggle');
        const closeCart = document.querySelector('.close-cart');
        const cartSidebar = document.getElementById('cart-sidebar');
        
        cartToggle.addEventListener('click', () => {
            cartSidebar.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        });
        
        closeCart.addEventListener('click', () => {
            cartSidebar.classList.add('hidden');
            document.body.style.overflow = '';
        });
        
        cartSidebar.addEventListener('click', (e) => {
            if (e.target === cartSidebar) {
                cartSidebar.classList.add('hidden');
                document.body.style.overflow = '';
            }
        });

        // Générer les sections de produits à partir du JSON
        function generateProductSections() {
            const container = document.getElementById('product-sections');
            container.innerHTML = '';
            
            productsData.categories.forEach(category => {
                const section = document.createElement('div');
                section.className = 'section';
                
                const sectionTitle = document.createElement('div');
                sectionTitle.className = 'section-title';
                sectionTitle.textContent = category.name;
                
                const carousel = document.createElement('div');
                carousel.className = 'carousel';
                
                category.products.forEach(product => {
                    const productCard = document.createElement('div');
                    productCard.className = 'product-card';
                    productCard.onclick = () => showProductDetail(
                        product.name, 
                        product.price, 
                        product.images, 
                        product.description
                    );
                    
                    productCard.innerHTML = `
                        <img class="product-image" src="${product.images[0]}" alt="${product.name}">
                        <div class="product-name">${product.name}</div>
                        <div class="product-price">${formatPrice(product.price)} FCFA</div>
                    `;
                    
                    carousel.appendChild(productCard);
                });
                
                section.appendChild(sectionTitle);
                section.appendChild(carousel);
                container.appendChild(section);
                
                // Activer le défilement horizontal
                setupCarousel(carousel);
            });
        }

        // Activer le défilement horizontal pour les carrousels
        function setupCarousel(carousel) {
            let isDown = false;
            let startX;
            let scrollLeft;

            carousel.addEventListener('mousedown', (e) => {
                isDown = true;
                startX = e.pageX - carousel.offsetLeft;
                scrollLeft = carousel.scrollLeft;
            });

            carousel.addEventListener('mouseleave', () => {
                isDown = false;
            });

            carousel.addEventListener('mouseup', () => {
                isDown = false;
            });

            carousel.addEventListener('mousemove', (e) => {
                if(!isDown) return;
                e.preventDefault();
                const x = e.pageX - carousel.offsetLeft;
                const walk = (x - startX) * 2;
                carousel.scrollLeft = scrollLeft - walk;
            });
        }

        // Activer le défilement horizontal pour le carrousel des détails
        function setupDetailCarousel(carousel) {
            let isDown = false;
            let startX;
            let scrollLeft;

            carousel.addEventListener('mousedown', (e) => {
                isDown = true;
                startX = e.pageX - carousel.offsetLeft;
                scrollLeft = carousel.scrollLeft;
            });

            carousel.addEventListener('mouseleave', () => {
                isDown = false;
            });

            carousel.addEventListener('mouseup', () => {
                isDown = false;
            });

            carousel.addEventListener('mousemove', (e) => {
                if(!isDown) return;
                e.preventDefault();
                const x = e.pageX - carousel.offsetLeft;
                const walk = (x - startX) * 2;
                carousel.scrollLeft = scrollLeft - walk;
            });
        }

        // Gestion de la recherche
        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');

        searchInput.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            
            if (searchTerm.length < 2) {
                searchResults.style.display = 'none';
                return;
            }
            
            const filteredProducts = allProducts.filter(product => 
                product.name.toLowerCase().includes(searchTerm)
            );
            
            displaySearchResults(filteredProducts);
        });

        function displaySearchResults(results) {
            if (results.length === 0) {
                searchResults.innerHTML = '<div class="search-result-item">Aucun résultat trouvé</div>';
                searchResults.style.display = 'block';
                return;
            }
            
            searchResults.innerHTML = '';
            results.forEach(product => {
                const resultItem = document.createElement('div');
                resultItem.className = 'search-result-item';
                resultItem.innerHTML = `
                    <img src="${product.images[0]}" alt="${product.name}">
                    <div class="search-result-info">
                        <div class="search-result-name">${product.name}</div>
                        <div class="search-result-price">${formatPrice(product.price)} FCFA</div>
                    </div>
                `;
                resultItem.addEventListener('click', () => {
                    showProductDetail(product.name, product.price, product.images, product.description);
                    searchResults.style.display = 'none';
                    searchInput.value = '';
                });
                searchResults.appendChild(resultItem);
            });
            
            searchResults.style.display = 'block';
        }

        // Fermer les résultats de recherche quand on clique ailleurs
        document.addEventListener('click', function(e) {
            if (e.target !== searchInput) {
                searchResults.style.display = 'none';
            }
        });

        // Fonctions pour la modale de détails
        let currentProduct = null;

        function showProductDetail(name, price, images, description) {
            currentProduct = allProducts.find(p => p.name === name);
            
            const carousel = document.getElementById('detailCarousel');
            carousel.innerHTML = '';
            
            // Ajouter les images au carrousel
            images.forEach(imageUrl => {
                const img = document.createElement('img');
                img.src = imageUrl;
                img.className = 'detail-carousel-image';
                carousel.appendChild(img);
            });
            
            // Activer le défilement horizontal
            setupDetailCarousel(carousel);
            
            document.getElementById('detailProductName').textContent = name;
            document.getElementById('detailProductPrice').textContent = `${formatPrice(price)} FCFA`;
            document.getElementById('detailProductDescription').textContent = description || 'Aucune description disponible';
            
            // Configurer le bouton "Ajouter au panier"
            const addToCartBtn = document.getElementById('detailAddToCart');
            addToCartBtn.onclick = function() {
                addToCart(currentProduct);
                closeProductDetail();
            };
            
            document.getElementById('productDetailModal').style.display = 'flex';
        }

        function closeProductDetail() {
            document.getElementById('productDetailModal').style.display = 'none';
        }

        // Fonction pour formater le prix
        function formatPrice(price) {
            return price.toString().replace(/\B(?=(\d{3})+(?!\d))/g, " ");
        }

        // Fonctions de gestion du panier
       function addToCart(product) {
    // Vérifier si le produit est déjà dans le panier
    const existingItem = cartItems.find(item => item.name === product.name);
    
    if (existingItem) {
        existingItem.quantity += 1;
    } else {
        cartItems.push({
            name: product.name,
            price: product.price,
            image: product.images[0],
            quantity: 1
        });
    }
    
    // Afficher la notification
    showCartNotification();
    
    // Mise à jour de l'interface
    updateCart();
}

// Fonction pour afficher la notification
function showCartNotification() {
    const notification = document.getElementById('cartNotification');
    notification.style.display = 'block';
    
    // Masquer la notification après 3 secondes
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease-out';
        setTimeout(() => {
            notification.style.display = 'none';
            notification.style.animation = 'slideIn 0.3s ease-out';
        }, 300);
    }, 3000);
}
        
        // Mise à jour du panier
        function updateCart() {
            // Mise à jour du compteur
            const totalItems = cartItems.reduce((sum, item) => sum + item.quantity, 0);
            cartCount.textContent = totalItems;
            
            // Mise à jour du contenu du panier
            cartItemsContainer.innerHTML = '';
            
            if (cartItems.length === 0) {
                cartItemsContainer.innerHTML = `
                    <div class="text-center py-8">
                        <i class="fas fa-shopping-cart text-gray-300 text-4xl mb-4"></i>
                        <p class="text-gray-500">Votre panier est vide</p>
                    </div>
                `;
                cartSubtotal.textContent = '0,00 FCFA';
                cartTotal.textContent = '0,00 FCFA';
                whatsappOrderBtn.href = '#';
                return;
            }
            
            let subtotal = 0;
            
            cartItems.forEach((item, index) => {
                const itemTotal = item.price * item.quantity;
                subtotal += itemTotal;
                
                const cartItemElement = document.createElement('div');
                cartItemElement.className = 'cart-item flex items-center border-b pb-4';
                cartItemElement.innerHTML = `
                    <img src="${item.image}" alt="${item.name}" class="w-16 h-16 object-cover rounded">
                    <div class="ml-4 flex-1">
                        <h4 class="font-medium">${item.name}</h4>
                        <div class="flex justify-between items-center mt-2">
                            <p class="font-bold text-green-600">${formatPrice(itemTotal)} FCFA</p>
                            <div class="flex items-center">
                                <button class="decrease-quantity text-gray-500" data-index="${index}">
                                    <i class="fas fa-minus"></i>
                                </button>
                                <span class="mx-2">${item.quantity}</span>
                                <button class="increase-quantity text-gray-500" data-index="${index}">
                                    <i class="fas fa-plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                    <button class="remove-item text-gray-400 hover:text-red-500 ml-2" data-index="${index}">
                        <i class="fas fa-trash"></i>
                    </button>
                `;
                
                cartItemsContainer.appendChild(cartItemElement);
            });
            
            // Mise à jour des totaux
            cartSubtotal.textContent = `${formatPrice(subtotal)} FCFA`;
            cartTotal.textContent = `${formatPrice(subtotal)} FCFA`;
            
            // Mise à jour du lien WhatsApp
            updateWhatsAppLink();
            
            // Ajout des écouteurs d'événements pour les boutons dans le panier
            document.querySelectorAll('.decrease-quantity').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = parseInt(e.target.closest('button').dataset.index);
                    decreaseQuantity(index);
                });
            });
            
            document.querySelectorAll('.increase-quantity').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = parseInt(e.target.closest('button').dataset.index);
                    increaseQuantity(index);
                });
            });
            
            document.querySelectorAll('.remove-item').forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = parseInt(e.target.closest('button').dataset.index);
                    removeItem(index);
                });
            });
        }
        
        function decreaseQuantity(index) {
            if (cartItems[index].quantity > 1) {
                cartItems[index].quantity -= 1;
            } else {
                cartItems.splice(index, 1);
            }
            updateCart();
        }
        
        function increaseQuantity(index) {
            cartItems[index].quantity += 1;
            updateCart();
        }
        
        function removeItem(index) {
            cartItems.splice(index, 1);
            updateCart();
        }
        
        // Mise à jour du lien WhatsApp
       // Mise à jour du lien WhatsApp - Version avec toutes les images
function updateWhatsAppLink() {
    if (cartItems.length === 0) return;
    
    let message = "Bonjour, je souhaite commander les articles suivants :%0A%0A";
    
    cartItems.forEach(item => {
        // Trouver le produit complet dans allProducts
        const fullProduct = allProducts.find(p => p.name === item.name);
        
        message += `*${item.name}* (x${item.quantity})%0A`;
        message += `Prix unitaire: ${formatPrice(item.price)} FCFA%0A`;
        message += `Total: ${formatPrice(item.price * item.quantity)} FCFA%0A`;
        
        // Ajouter toutes les images du produit
        if (fullProduct && fullProduct.images && fullProduct.images.length > 0) {
            message += `%0AImages du produit :%0A`;
            fullProduct.images.forEach(img => {
                message += `${img}%0A`;
            });
        }
        
        if (fullProduct && fullProduct.description) {
            message += `%0ADescription: ${fullProduct.description}%0A`;
        }
        
        message += `%0A----------------------------%0A%0A`;
    });
    
    message += `*Total général : ${cartTotal.textContent}*%0A%0AMerci !`;
    
    whatsappOrderBtn.href = `https://wa.me/221781921199?text=${message}`;
}

        // Initialiser l'application
        document.addEventListener('DOMContentLoaded', loadProductsData);
        // Initialisation du Swiper publicitaire
const adSwiper = new Swiper('.ad-swiper', {
    // Optional parameters
    loop: true,
    autoplay: {
        delay: 3000,
        disableOnInteraction: false,
    },
    pagination: {
        el: '.swiper-pagination',
        clickable: true,
    },
});
    </script>
</body>
</html>